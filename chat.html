<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Chat</title>
    <style>
      body {
        font-family: Arial, sans-serif;
      }
      #messages {
        border: 1px solid #ccc;
        height: 200px;
        padding: 10px;
        overflow-y: auto;
        margin-bottom: 10px;
      }

      .icon-wrapper {
        position: relative;   /* anchor for badge */
        width: 32px;
        height: 32px;
      }

      .icon {
        width: 100%;
        height: 100%;
      }

      .badge {
        position: absolute;
        top: -6px;
        right: -6px;

        min-width: 18px;
        height: 18px;
        padding: 0 4px;

        background-color: red;
        color: white;

        font-size: 12px;
        font-weight: bold;

        border-radius: 999px;

        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <h2>Chat App</h2>
    <div class="icon-wrapper">
      <img
        src="https://cdn-icons-png.flaticon.com/512/1827/1827392.png"
        alt="notifications"
        class="icon"
      />
      <span class="badge">5</span>
    </div>
    <div id="messages"></div>

    <input id="input" placeholder="Type a message..." />
    <button id="send">Send</button>

    <script>
      // 1. Connect to WebSocket server
      const socket = new WebSocket("ws://localhost:3000");

      const messagesDiv = document.getElementById("messages");
      const input = document.getElementById("input");
      const sendBtn = document.getElementById("send");

      // 2. When connection opens
      socket.onopen = () => {
        addMessage("Connected to server");
      };

      // 3. When a message is received
      socket.onmessage = (event) => {
        addMessage("Server: " + event.data);
      };

      // 4. Send message to server
      sendBtn.onclick = () => {
        const text = input.value;
        if (text) {
          socket.send(text);
          addMessage("You: " + text);
          input.value = "";
        }
      };

      function addMessage(text) {
        const div = document.createElement("div");
        div.textContent = text;
        messagesDiv.appendChild(div);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
      }
    </script>
  </body>
</html>
